{% if view == 'list' %}
<div class="space-y-4">
    {% if events %}
    {% for event in events %}
    <div class="card bg-base-200 shadow-sm hover:shadow-md transition-shadow">
        <div class="card-body">
            <div class="flex flex-col md:flex-row md:items-start gap-4">
                {% if event.occurrences and event.occurrences|length > 0 %}
                <div class="flex-shrink-0">
                    <div class="bg-python-blue text-white rounded-lg p-3 text-center w-16">
                        <div class="text-xs font-semibold">{{ event.occurrences[0].dt_start.strftime('%b').upper() }}</div>
                        <div class="text-2xl font-bold">{{ event.occurrences[0].dt_start.day }}</div>
                    </div>
                </div>
                {% endif %}

                <div class="flex-grow">
                    <h4 class="text-lg font-semibold mb-2">
                        <a href="/events/{{ event.slug }}/" class="python-link">
                            {{ event.title|safe }}
                        </a>
                    </h4>

                    {% if event.description %}
                    <p class="text-sm text-base-content/70 mb-2 line-clamp-2">{{ event.description|striptags|truncate(150) }}</p>
                    {% endif %}

                    {% if event.venue %}
                    <div class="flex items-center gap-2 text-sm text-base-content/70">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <span>{{ event.venue.name }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="alert alert-info">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span>No events in this calendar yet.</span>
    </div>
    {% endif %}
</div>
{% elif view == 'week' %}
<div class="bg-base-200 rounded-lg overflow-hidden">
    <div class="grid grid-cols-7 gap-px bg-base-300">
        {% for day in week_data %}
        <div class="bg-base-200 p-2 text-center">
            <div class="font-semibold text-sm">{{ day.date.strftime('%a') }}</div>
            <div class="text-xs text-base-content/70">{{ day.date.strftime('%b %d') }}</div>
        </div>
        {% endfor %}
    </div>

    <div class="grid grid-cols-7 gap-px bg-base-300">
        {% for day in week_data %}
        <div class="bg-base-100 min-h-[200px] p-2 {% if day.is_today %}ring-2 ring-python-blue{% endif %}">
            {% if day.events %}
            <div class="space-y-1">
                {% for event in day.events[:5] %}
                <a href="/events/{{ event.slug }}/" class="block text-xs p-1 bg-python-blue/10 hover:bg-python-blue/20 rounded truncate" title="{{ event.title }}">
                    {{ event.title|safe }}
                </a>
                {% endfor %}
                {% if day.event_count > 5 %}
                <div class="text-xs text-base-content/60">
                    +{{ day.event_count - 5 }} more
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="text-xs text-base-content/40 text-center mt-4">No events</div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="bg-base-200 rounded-lg overflow-hidden">
    <div class="grid grid-cols-7 gap-px bg-base-300">
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Sun</div>
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Mon</div>
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Tue</div>
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Wed</div>
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Thu</div>
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Fri</div>
        <div class="bg-base-200 p-3 text-center font-semibold text-sm">Sat</div>
    </div>

    <div class="grid grid-cols-7 gap-px bg-base-300">
        {% for day in calendar_data %}
        <div class="bg-base-100 min-h-[120px] p-2 {% if day.is_today %}ring-2 ring-python-blue{% endif %} {% if not day.in_month %}opacity-50{% endif %}">
            <div class="flex justify-between items-start mb-2">
                <span class="text-sm font-semibold {% if day.is_today %}text-python-blue{% endif %}">
                    {{ day.date.day }}
                </span>
                {% if day.event_count > 0 %}
                <span class="badge badge-primary badge-xs">{{ day.event_count }}</span>
                {% endif %}
            </div>

            {% if day.events %}
            <div class="space-y-1">
                {% for event in day.events[:3] %}
                <a href="/events/{{ event.slug }}/" class="block text-xs p-1 bg-python-blue/10 hover:bg-python-blue/20 rounded truncate" title="{{ event.title }}">
                    {{ event.title|safe }}
                </a>
                {% endfor %}
                {% if day.event_count > 3 %}
                <div class="text-xs text-base-content/60">
                    +{{ day.event_count - 3 }} more
                </div>
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}
