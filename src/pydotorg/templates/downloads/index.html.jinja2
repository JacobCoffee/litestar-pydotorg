{% extends "base.html.jinja2" %}
{% import "macros/buttons.html.jinja2" as buttons %}
{% import "macros/cards.html.jinja2" as cards %}

{% block title %}Download Python | Python.org{% endblock %}

{% block meta_description %}Download the latest version of Python. Official Python downloads for Windows, macOS, and Linux.{% endblock %}

{% block content %}
<section class="python-gradient text-white">
    <div class="section-container py-20">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-5xl md:text-6xl font-bold mb-6">
                Download Python
            </h1>
            {% if latest_python3 %}
            <p class="text-xl md:text-2xl mb-8 opacity-90">
                The latest stable release is Python {{ latest_python3.version }}
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                {{ buttons.download_button('Download Python ' + latest_python3.version, '/downloads/release/' + latest_python3.slug + '/', 'lg', 'Latest stable release') }}
                <a href="/downloads/source/" class="btn btn-outline btn-lg text-white border-white hover:bg-white/10">
                    Download Source
                </a>
            </div>
            {% else %}
            <p class="text-xl md:text-2xl mb-8 opacity-90">
                Get the latest version of Python
            </p>
            {% endif %}
        </div>
    </div>
</section>

<section class="bg-base-100 py-16">
    <div class="section-container">
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold text-python-blue mb-4">Quick Downloads</h2>
            <p class="text-lg text-base-content/80">Choose your operating system</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
            {{ cards.download_card(
                'Windows',
                latest_python3.version if latest_python3 else '3.12',
                '',
                '/downloads/windows/',
                '<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-python-blue" fill="currentColor" viewBox="0 0 24 24"><path d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801"/></svg>'
            ) }}

            {{ cards.download_card(
                'macOS',
                latest_python3.version if latest_python3 else '3.12',
                '',
                '/downloads/macos/',
                '<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-python-blue" fill="currentColor" viewBox="0 0 24 24"><path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/></svg>'
            ) }}

            {{ cards.download_card(
                'Linux/Unix',
                latest_python3.version if latest_python3 else '3.12',
                '',
                '/downloads/source/',
                '<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-python-blue" fill="currentColor" viewBox="0 0 448 512"><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7zm-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4zM420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7zM223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8zM183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1zm-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3-1.4-4.9 0-9 4.2-12.3zm3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9zm-30.5-19.8c-1.4-5.2-5.1-11.5-11.4-16.1-3.1-2.3-6.8-4.2-10.8-5.4l-1-.3c-.5-.2-3.4-1.5-3.5-2-.2-.5.7-1.4 1.1-1.7l3-3c.9-.9 2.1-1.8 3.5-2.6 7.4-4.7 17.8-7.7 21.2-3.5 3.5 4.3 1.5 22.5-2.1 34.6zm5.3-69c-3.5 5.4-8.1 8.8-13.9 11.2-5.9 2.5-12.8 4.1-20.5 5.8l-4.6 1-.2-.2c-7.6-9.5-14.5-15.6-22.8-16.9-11.3-1.6-19.9 3.2-27.5 12.1-9.2 11.2-10.4 19.7-24.8 26.1-6.7 3.1-12.6 4.6-17.4 4.3-5.1-.2-8.7-2-10.6-5.8-4.2-8.2-2.2-22.3 3.3-37.4 6.2-17.2 16.6-32.6 26.4-44.6 6.7-8.2 13.3-14.6 18.3-18.3 5-3.7 6.5-4 8.1-4.5 2.3.8 3.4 1.8 6.2 3.2 6.1 3 17.5 8.1 29.3 11.8 12.5 3.8 25.8 6.5 35.6 5.3 3.2-.4 5.7-1.3 7.4-2.5 0 0 4.9 3.3 7.5 5.6 5.3 4.7 10 10.1 13.7 15.7 3.7 5.6 6.5 11.5 7.9 17.4 1.4 6 1.3 12.2-1.6 17.5-2.9 5.3-8.1 10.1-16.8 13.5-3 1.2-6.4 2.1-9.8 2.8-3.5.8-7.1 1.3-10.6 1.7l-6.5.6zm65.5 28.5c-3.9-3.2-7.6-6.5-10.4-10.5-.3-.4-.6-.8-.9-1.2-1.6-2.2-2.8-4.5-3.5-7-1.9-6.3-.3-13.4 3.1-19.8 3.4-6.4 8.5-12.1 13.9-16.6 5.4-4.6 11-8.1 15.7-10.3 4.7-2.2 8.3-3.2 9.8-2.8 1.5.4 5.9 2.8 10.2 5.9 4.2 3.1 8.4 6.8 11.2 10.6 2.8 3.8 4.5 7.5 3.7 10.4-1.8 7-6 12.7-10.6 17.5-4.6 4.8-9.6 8.6-13.6 11.5-4 2.8-7.1 4.8-8.1 5.8-4.8 4.3-11.7 7.6-20.5 6.5z"/></svg>'
            ) }}
        </div>

        <div class="text-center mt-8">
            <p class="text-base-content/60">
                Looking for a specific version? See <a href="#all-releases" class="python-link">all releases</a> below.
            </p>
        </div>
    </div>
</section>

<section class="bg-base-200 py-16" id="all-releases">
    <div class="section-container">
        <div class="max-w-6xl mx-auto">
            <div class="mb-8">
                <h2 class="text-4xl font-bold text-python-blue mb-4">All Releases</h2>
                <p class="text-lg text-base-content/80">Browse all Python releases grouped by version</p>
            </div>

            {% if grouped_releases %}
            <div class="space-y-8">
                {% for major_version, minor_groups in grouped_releases.items() %}
                {% set is_python3 = major_version == "3" %}
                {% set is_major_eol = major_version == "2" %}

                <div class="bg-base-100 rounded-lg shadow-lg p-6">
                    <div class="flex items-center gap-3 mb-6 pb-4 border-b border-base-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-python-blue" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                        </svg>
                        <h3 class="text-2xl font-bold text-python-blue">Python {{ major_version }}</h3>
                        {% if is_major_eol %}
                        <span class="badge badge-warning gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            End of Life
                        </span>
                        {% endif %}
                    </div>

                    {% set active_versions = [] %}
                    {% set eol_versions = [] %}
                    {% for minor_version, releases in minor_groups.items() %}
                        {% if releases[0].is_eol %}
                            {% set _ = eol_versions.append((minor_version, releases)) %}
                        {% else %}
                            {% set _ = active_versions.append((minor_version, releases)) %}
                        {% endif %}
                    {% endfor %}

                    <div class="space-y-4" data-version-group="{{ major_version }}">
                        {% for minor_version, releases in active_versions %}
                        {% set is_latest = releases[0].is_latest %}
                        {% set release_count = releases|length %}
                        {% set stable_count = releases|selectattr('pre_release', 'false')|list|length %}
                        {% set version_id = 'version-' ~ major_version ~ '-' ~ minor_version|replace('.', '-') %}

                        {% if loop.first and is_python3 %}
                        <div class="card bg-gradient-to-br from-python-blue to-python-yellow text-white">
                            <div class="card-body">
                                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                                    <div>
                                        <div class="flex items-center gap-2 mb-2">
                                            <h4 class="text-2xl font-bold">Python {{ minor_version }}</h4>
                                            {% if is_latest %}
                                            <span class="badge badge-accent badge-lg gap-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                                                </svg>
                                                Latest Stable
                                            </span>
                                            {% endif %}
                                        </div>
                                        <p class="opacity-90">
                                            {{ release_count }} release{{ 's' if release_count != 1 else '' }}
                                            {% if stable_count > 0 and stable_count != release_count %}
                                            ({{ stable_count }} stable)
                                            {% endif %}
                                        </p>
                                        {% if releases[0].release_date %}
                                        <p class="text-sm opacity-75 mt-1">
                                            Latest: {{ releases[0].name }} - {{ releases[0].release_date.strftime('%B %d, %Y') }}
                                        </p>
                                        {% endif %}
                                    </div>
                                    <div class="flex gap-2">
                                        <a href="/downloads/release/{{ releases[0].slug }}/" class="btn btn-accent gap-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                            </svg>
                                            Download
                                        </a>
                                        <button
                                            class="btn btn-outline border-white text-white hover:bg-white/10 gap-2"
                                            onclick="toggleVersionDetails('{{ version_id }}')"
                                            aria-expanded="false"
                                            aria-controls="{{ version_id }}"
                                        >
                                            <span>All Releases</span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="{{ version_id }}" class="version-details hidden overflow-hidden">
                            {{ render_version_table(releases) }}
                        </div>

                        {% else %}
                        {{ render_version_pill(minor_version, releases, is_latest, release_count, stable_count, version_id) }}
                        {% endif %}
                        {% endfor %}

                        {% if eol_versions|length > 0 and is_python3 %}
                        <div class="divider my-8">
                            <button
                                class="btn btn-ghost btn-sm gap-2 text-base-content/60 hover:text-error"
                                onclick="toggleEolSection('eol-section-{{ major_version }}')"
                                aria-expanded="false"
                                aria-controls="eol-section-{{ major_version }}"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                </svg>
                                <span>End of Life Versions ({{ eol_versions|length }})</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform eol-chevron" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                        </div>

                        <div id="eol-section-{{ major_version }}" class="eol-section hidden overflow-hidden">
                            <div class="space-y-4 pt-2">
                                {% for minor_version, releases in eol_versions %}
                                {% set release_count = releases|length %}
                                {% set stable_count = releases|selectattr('pre_release', 'false')|list|length %}
                                {% set version_id = 'version-' ~ major_version ~ '-' ~ minor_version|replace('.', '-') %}

                                <div class="opacity-75 hover:opacity-100 transition-opacity">
                                    <button
                                        class="version-pill group w-full text-left px-4 py-3 rounded-lg border-2 transition-all duration-200 border-error/30 bg-error/5 hover:bg-error/10 hover:border-error/50"
                                        onclick="toggleVersionDetails('{{ version_id }}')"
                                        aria-expanded="false"
                                        aria-controls="{{ version_id }}"
                                    >
                                        <div class="flex items-center justify-between gap-4">
                                            <div class="flex items-center gap-3 min-w-0 flex-1">
                                                <div class="flex-shrink-0">
                                                    <div class="w-10 h-10 rounded-full bg-error/10 flex items-center justify-center text-error font-bold">
                                                        {{ minor_version.split('.')[1] }}
                                                    </div>
                                                </div>
                                                <div class="min-w-0 flex-1">
                                                    <div class="flex items-center gap-2 flex-wrap">
                                                        <span class="font-semibold text-lg text-base-content/70">
                                                            Python {{ minor_version }}
                                                        </span>
                                                        <span class="badge badge-error badge-sm">EOL</span>
                                                    </div>
                                                    <div class="text-sm text-base-content/50 flex items-center gap-2 flex-wrap mt-1">
                                                        <span>{{ release_count }} release{{ 's' if release_count != 1 else '' }}</span>
                                                        {% if releases[0].eol_date %}
                                                        <span class="opacity-50">•</span>
                                                        <span>EOL: {{ releases[0].eol_date.strftime('%b %Y') }}</span>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex items-center gap-2 flex-shrink-0">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-base-content/40 transition-transform group-hover:text-error" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                                </svg>
                                            </div>
                                        </div>
                                    </button>

                                    <div id="{{ version_id }}" class="version-details hidden overflow-hidden mt-3">
                                        <div class="overflow-x-auto rounded-lg border border-base-300">
                                            <table class="table w-full">
                                                <thead class="bg-base-200">
                                                    <tr>
                                                        <th>Version</th>
                                                        <th>Release Date</th>
                                                        <th>Type</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for release in releases %}
                                                    <tr class="hover">
                                                        <td>
                                                            <a href="/downloads/release/{{ release.slug }}/" class="font-semibold text-python-blue hover:underline">
                                                                {{ release.name }}
                                                            </a>
                                                        </td>
                                                        <td>
                                                            {% if release.release_date %}
                                                                {{ release.release_date.strftime('%B %d, %Y') }}
                                                            {% else %}
                                                                -
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            <span class="badge badge-error badge-sm">End of Life</span>
                                                        </td>
                                                        <td>
                                                            <a href="/downloads/release/{{ release.slug }}/" class="btn btn-outline btn-sm gap-2">
                                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                                                </svg>
                                                                Download
                                                            </a>
                                                        </td>
                                                    </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        {% if is_major_eol %}
                        {% for minor_version, releases in minor_groups.items() %}
                        {% set release_count = releases|length %}
                        {% set version_id = 'version-' ~ major_version ~ '-' ~ minor_version|replace('.', '-') %}

                        <div class="opacity-75 hover:opacity-100 transition-opacity">
                            <button
                                class="version-pill group w-full text-left px-4 py-3 rounded-lg border-2 transition-all duration-200 border-warning/30 bg-warning/5 hover:bg-warning/10 hover:border-warning/50"
                                onclick="toggleVersionDetails('{{ version_id }}')"
                                aria-expanded="false"
                                aria-controls="{{ version_id }}"
                            >
                                <div class="flex items-center justify-between gap-4">
                                    <div class="flex items-center gap-3 min-w-0 flex-1">
                                        <div class="flex-shrink-0">
                                            <div class="w-10 h-10 rounded-full bg-warning/10 flex items-center justify-center text-warning font-bold">
                                                {{ minor_version.split('.')[1] }}
                                            </div>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <div class="flex items-center gap-2 flex-wrap">
                                                <span class="font-semibold text-lg text-base-content/70">
                                                    Python {{ minor_version }}
                                                </span>
                                                <span class="badge badge-warning badge-sm">EOL</span>
                                            </div>
                                            <div class="text-sm text-base-content/50 flex items-center gap-2 flex-wrap mt-1">
                                                <span>{{ release_count }} release{{ 's' if release_count != 1 else '' }}</span>
                                                {% if releases[0].eol_date %}
                                                <span class="opacity-50">•</span>
                                                <span>EOL: {{ releases[0].eol_date.strftime('%b %Y') }}</span>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 flex-shrink-0">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-base-content/40 transition-transform group-hover:text-warning" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                        </svg>
                                    </div>
                                </div>
                            </button>

                            <div id="{{ version_id }}" class="version-details hidden overflow-hidden mt-3">
                                <div class="overflow-x-auto rounded-lg border border-base-300">
                                    <table class="table w-full">
                                        <thead class="bg-base-200">
                                            <tr>
                                                <th>Version</th>
                                                <th>Release Date</th>
                                                <th>Type</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for release in releases %}
                                            <tr class="hover">
                                                <td>
                                                    <a href="/downloads/release/{{ release.slug }}/" class="font-semibold text-python-blue hover:underline">
                                                        {{ release.name }}
                                                    </a>
                                                </td>
                                                <td>
                                                    {% if release.release_date %}
                                                        {{ release.release_date.strftime('%B %d, %Y') }}
                                                    {% else %}
                                                        -
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    <span class="badge badge-warning badge-sm">End of Life</span>
                                                </td>
                                                <td>
                                                    <a href="/downloads/release/{{ release.slug }}/" class="btn btn-outline btn-sm gap-2">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                                        </svg>
                                                        Download
                                                    </a>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>

            <script>
                function toggleVersionDetails(versionId) {
                    const details = document.getElementById(versionId);
                    const button = document.querySelector(`[aria-controls="${versionId}"]`);
                    const icon = button.querySelector('svg:last-child');

                    if (details.classList.contains('hidden')) {
                        details.classList.remove('hidden');
                        details.style.maxHeight = '0px';
                        requestAnimationFrame(() => {
                            details.style.transition = 'max-height 0.3s ease-out';
                            details.style.maxHeight = details.scrollHeight + 'px';
                        });
                        button.setAttribute('aria-expanded', 'true');
                        if (icon) icon.style.transform = 'rotate(180deg)';
                    } else {
                        details.style.maxHeight = '0px';
                        setTimeout(() => {
                            details.classList.add('hidden');
                            details.style.maxHeight = '';
                        }, 300);
                        button.setAttribute('aria-expanded', 'false');
                        if (icon) icon.style.transform = 'rotate(0deg)';
                    }
                }

                function toggleEolSection(sectionId) {
                    const section = document.getElementById(sectionId);
                    const button = document.querySelector(`[aria-controls="${sectionId}"]`);
                    const chevron = button.querySelector('.eol-chevron');

                    if (section.classList.contains('hidden')) {
                        section.classList.remove('hidden');
                        section.style.maxHeight = '0px';
                        requestAnimationFrame(() => {
                            section.style.transition = 'max-height 0.4s ease-out';
                            section.style.maxHeight = section.scrollHeight + 'px';
                        });
                        button.setAttribute('aria-expanded', 'true');
                        if (chevron) chevron.style.transform = 'rotate(180deg)';
                    } else {
                        section.style.maxHeight = '0px';
                        setTimeout(() => {
                            section.classList.add('hidden');
                            section.style.maxHeight = '';
                        }, 400);
                        button.setAttribute('aria-expanded', 'false');
                        if (chevron) chevron.style.transform = 'rotate(0deg)';
                    }
                }

                document.addEventListener('DOMContentLoaded', () => {
                    document.querySelectorAll('.version-pill, [onclick^="toggleVersionDetails"], [onclick^="toggleEolSection"]').forEach(button => {
                        button.addEventListener('keydown', (e) => {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                button.click();
                            }
                        });
                    });
                });
            </script>
            {% else %}
            <div class="alert alert-info">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>No releases are currently available.</span>
            </div>
            {% endif %}
        </div>
    </div>
</section>

{% macro render_version_table(releases) %}
<div class="overflow-x-auto rounded-lg border border-base-300">
    <table class="table w-full">
        <thead class="bg-base-200">
            <tr>
                <th>Version</th>
                <th>Release Date</th>
                <th>Type</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for release in releases %}
            <tr class="hover">
                <td>
                    <a href="/downloads/release/{{ release.slug }}/" class="font-semibold text-python-blue hover:underline">
                        {{ release.name }}
                    </a>
                    {% if release.is_latest %}
                    <span class="badge badge-primary badge-xs ml-2">Latest</span>
                    {% endif %}
                </td>
                <td>
                    {% if release.release_date %}
                        {{ release.release_date.strftime('%B %d, %Y') }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if release.is_eol %}
                        <span class="badge badge-error badge-sm">End of Life</span>
                    {% elif release.is_prerelease %}
                        <span class="badge badge-warning badge-sm">Pre-release</span>
                    {% elif release.status.value == 'security' %}
                        <span class="badge badge-info badge-sm">Security</span>
                    {% else %}
                        <span class="badge badge-success badge-sm">{{ release.status_label }}</span>
                    {% endif %}
                </td>
                <td>
                    <a href="/downloads/release/{{ release.slug }}/" class="btn btn-primary btn-sm gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                        Download
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endmacro %}

{% macro render_version_pill(minor_version, releases, is_latest, release_count, stable_count, version_id) %}
<div>
    <button
        class="version-pill group w-full text-left px-4 py-3 rounded-lg border-2 transition-all duration-200
               {% if is_latest %}
               border-primary bg-primary/5 hover:bg-primary/10
               {% elif releases[0].status.value == 'security' %}
               border-info/30 bg-info/5 hover:bg-info/10 hover:border-info
               {% else %}
               border-base-300 bg-base-100 hover:bg-base-200 hover:border-python-blue
               {% endif %}"
        onclick="toggleVersionDetails('{{ version_id }}')"
        aria-expanded="false"
        aria-controls="{{ version_id }}"
    >
        <div class="flex items-center justify-between gap-4">
            <div class="flex items-center gap-3 min-w-0 flex-1">
                <div class="flex-shrink-0">
                    <div class="w-10 h-10 rounded-full {% if releases[0].status.value == 'security' %}bg-info/10 text-info{% else %}bg-python-blue/10 text-python-blue{% endif %} flex items-center justify-center font-bold">
                        {{ minor_version.split('.')[1] }}
                    </div>
                </div>
                <div class="min-w-0 flex-1">
                    <div class="flex items-center gap-2 flex-wrap">
                        <span class="font-semibold text-lg {% if is_latest %}text-primary{% elif releases[0].status.value == 'security' %}text-info{% else %}text-python-blue{% endif %}">
                            Python {{ minor_version }}
                        </span>
                        {% if is_latest %}
                        <span class="badge badge-primary badge-sm">Latest</span>
                        {% elif releases[0].status.value == 'security' %}
                        <span class="badge badge-info badge-sm">Security</span>
                        {% endif %}
                    </div>
                    <div class="text-sm text-base-content/60 flex items-center gap-2 flex-wrap mt-1">
                        <span>{{ release_count }} release{{ 's' if release_count != 1 else '' }}</span>
                        {% if stable_count > 0 and stable_count != release_count %}
                        <span class="opacity-50">•</span>
                        <span>{{ stable_count }} stable</span>
                        {% endif %}
                        {% if releases[0].release_date %}
                        <span class="opacity-50 hidden sm:inline">•</span>
                        <span class="hidden sm:inline">{{ releases[0].release_date.strftime('%b %Y') }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-2 flex-shrink-0">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-base-content/40 transition-transform group-hover:text-python-blue" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
        </div>
    </button>

    <div id="{{ version_id }}" class="version-details hidden overflow-hidden mt-3">
        <div class="overflow-x-auto rounded-lg border border-base-300">
            <table class="table w-full">
                <thead class="bg-base-200">
                    <tr>
                        <th>Version</th>
                        <th>Release Date</th>
                        <th>Type</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for release in releases %}
                    <tr class="hover">
                        <td>
                            <a href="/downloads/release/{{ release.slug }}/" class="font-semibold text-python-blue hover:underline">
                                {{ release.name }}
                            </a>
                            {% if release.is_latest %}
                            <span class="badge badge-primary badge-xs ml-2">Latest</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if release.release_date %}
                                {{ release.release_date.strftime('%B %d, %Y') }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td>
                            {% if release.is_eol %}
                                <span class="badge badge-error badge-sm">End of Life</span>
                            {% elif release.is_prerelease %}
                                <span class="badge badge-warning badge-sm">Pre-release</span>
                            {% elif release.status.value == 'security' %}
                                <span class="badge badge-info badge-sm">Security</span>
                            {% else %}
                                <span class="badge badge-success badge-sm">{{ release.status_label }}</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="/downloads/release/{{ release.slug }}/" class="btn btn-primary btn-sm gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                Download
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endmacro %}

<section class="bg-base-100 py-16">
    <div class="section-container">
        <div class="max-w-4xl mx-auto">
            <div class="card bg-base-200">
                <div class="card-body">
                    <h2 class="card-title text-2xl text-python-blue mb-4">Alternative Implementations</h2>
                    <div class="prose max-w-none">
                        <p class="text-base-content/80">
                            This site hosts the "traditional" implementation of Python (nicknamed CPython).
                            A number of alternative implementations are available as well:
                        </p>
                        <ul class="text-base-content/80">
                            <li><a href="https://www.jython.org/" class="python-link">Jython</a> - Python implemented in Java</li>
                            <li><a href="https://ironpython.net/" class="python-link">IronPython</a> - Python implemented in .NET</li>
                            <li><a href="https://pypy.org/" class="python-link">PyPy</a> - Python implemented in Python with JIT compiler</li>
                            <li><a href="https://github.com/RustPython/RustPython" class="python-link">RustPython</a> - Python implemented in Rust</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% if latest_python2 %}
<section class="bg-base-200 py-16">
    <div class="section-container">
        <div class="max-w-4xl mx-auto">
            <div class="alert alert-warning">
                <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
                <div>
                    <h3 class="font-bold">Python 2.7.x End of Life</h3>
                    <div class="text-sm">
                        Python 2.7 reached end of life on January 1st, 2020. The last version is {{ latest_python2.version }}.
                        Please upgrade to Python 3.
                        <a href="/downloads/release/{{ latest_python2.slug }}/" class="python-link ml-2">Download Python {{ latest_python2.version }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}
