{% if results and results.hits %}
<div class="mb-6">
    <p class="text-base-content/70">
        Found <strong>{{ results.total }}</strong> result{{ 's' if results.total != 1 else '' }}
        {% if results.processing_time_ms %}
        <span class="text-sm">({{ results.processing_time_ms }}ms)</span>
        {% endif %}
    </p>
</div>

<div class="space-y-4">
    {% for hit in results.hits %}
    <article class="card bg-base-200 shadow-sm hover:shadow-md transition-all duration-200 hover:border-python-blue border border-transparent">
        <div class="card-body">
            <div class="flex items-start justify-between gap-4">
                <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                        {% if hit.content_type == 'job' %}
                        <span class="badge badge-primary badge-sm">Job</span>
                        {% elif hit.content_type == 'event' %}
                        <span class="badge badge-secondary badge-sm">Event</span>
                        {% elif hit.content_type == 'blog' %}
                        <span class="badge badge-accent badge-sm">Blog</span>
                        {% elif hit.content_type == 'page' %}
                        <span class="badge badge-info badge-sm">Page</span>
                        {% else %}
                        <span class="badge badge-outline badge-sm">{{ hit.content_type|title }}</span>
                        {% endif %}

                        {% if hit.created %}
                        <span class="text-xs text-base-content/60">
                            {{ hit.created.strftime('%B %d, %Y') }}
                        </span>
                        {% endif %}
                    </div>

                    <h3 class="card-title text-xl mb-2">
                        <a href="{{ hit.url }}" class="python-link hover:text-python-yellow transition-colors">
                            {{ hit.title }}
                        </a>
                    </h3>

                    {% if hit.description %}
                    <p class="text-base-content/80 mb-3">
                        {{ hit.description[:200] }}{% if hit.description|length > 200 %}...{% endif %}
                    </p>
                    {% endif %}

                    <div class="text-sm text-base-content/60">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                        </svg>
                        <a href="{{ hit.url }}" class="hover:underline break-all">{{ hit.url }}</a>
                    </div>

                    {% if hit.extra %}
                    <div class="flex flex-wrap gap-2 mt-3">
                        {% if hit.extra.company_name %}
                        <span class="text-xs text-base-content/60">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                            {{ hit.extra.company_name }}
                        </span>
                        {% endif %}

                        {% if hit.extra.location %}
                        <span class="text-xs text-base-content/60">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            {{ hit.extra.location }}
                        </span>
                        {% endif %}

                        {% if hit.extra.remote %}
                        <span class="badge badge-success badge-xs">Remote</span>
                        {% endif %}

                        {% if hit.extra.venue %}
                        <span class="text-xs text-base-content/60">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                            {{ hit.extra.venue }}
                        </span>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </article>
    {% endfor %}
</div>

{% if results.total > results.limit %}
<div class="flex justify-center mt-8">
    <div class="join">
        {% if results.offset > 0 %}
        <button
            class="join-item btn btn-sm"
            hx-get="/search/results?q={{ query }}&limit={{ results.limit }}&offset={{ [0, results.offset - results.limit]|max }}"
            hx-target="#search-results"
            hx-swap="outerHTML"
        >
            Previous
        </button>
        {% endif %}

        {% set current_page = (results.offset // results.limit) + 1 %}
        {% set total_pages = (results.total // results.limit) + (1 if results.total % results.limit else 0) %}

        <button class="join-item btn btn-sm btn-active">
            Page {{ current_page }} of {{ total_pages }}
        </button>

        {% if results.offset + results.limit < results.total %}
        <button
            class="join-item btn btn-sm"
            hx-get="/search/results?q={{ query }}&limit={{ results.limit }}&offset={{ results.offset + results.limit }}"
            hx-target="#search-results"
            hx-swap="outerHTML"
        >
            Next
        </button>
        {% endif %}
    </div>
</div>
{% endif %}

{% else %}
<div class="card bg-base-200 shadow-sm">
    <div class="card-body text-center py-16">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 mx-auto text-base-content/30 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <h3 class="text-2xl font-bold mb-2">No results found</h3>
        <p class="text-base-content/70 mb-4">
            Try different keywords or check your spelling.
        </p>
        <a href="/search" class="btn btn-primary btn-sm">
            New Search
        </a>
    </div>
</div>
{% endif %}
